<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Subset, and/or summarize HarvestChoice 5-arc-minute layers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for getLayer {hcapi3}"><tr><td>getLayer {hcapi3}</td><td align="right">R Documentation</td></tr></table>

<h2>Subset, and/or summarize HarvestChoice 5-arc-minute layers</h2>

<h3>Description</h3>

<p>Workhorse method to subset and/or aggregate HarvestChoice layers.
This method also aggregates classified variables by continuous variables.\
e.g. <code>getLayer(var=c("whea_h", "AEZ16_CLAS"), by=c("ADM2_NAME_ALT", "bmi"))</code>.
It does so by returning the dominant class of a classified variable within each <code>by</code>
class, and by automatically classifying any continuous variable passed to <code>by</code>
using default value breaks as specified in the variable metadata.
The formula used to aggregate classified variables by choosing the dominant class is
<code>names(sort(table({varCode}), decreasing=T)[1])</code>. This formula computes the
frequency of each class, ranks them by decreasing frequency, and retains the top one.
Layers can also be summarized over a spatial area (passed as an integer array of CELL5M ids).
</p>


<h3>Usage</h3>

<pre>
getLayer(var, iso3 = "SSA", by = NULL, ids = NULL, collapse = TRUE,
  as.class = "data.table")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>var</code></td>
<td>
<p>character array of variable names (all types are accepted)</p>
</td></tr>
<tr valign="top"><td><code>iso3</code></td>
<td>
<p>optional array of country or regional codes to filter by (3-letter code)</p>
</td></tr>
<tr valign="top"><td><code>by</code></td>
<td>
<p>optional character array of variables to group by (all types are accepted)</p>
</td></tr>
<tr valign="top"><td><code>ids</code></td>
<td>
<p>optional gridcell ids to return (if collapse=F) or summarize by (if collapse=T)</p>
</td></tr>
<tr valign="top"><td><code>collapse</code></td>
<td>
<p>if FALSE always return all pixel values (useful for plotting and to convert to spatial formats)</p>
</td></tr>
<tr valign="top"><td><code>as.class</code></td>
<td>
<p><code>c("data.table", "list")</code> by default returns a simple data.table. If <code>as.class="list"</code> returns a well-constructed list with variable metadata</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table (or json array) of <code>var</code> indicators aggregated by <code>by</code> domains
</p>

<hr><div align="center">[Package <em>hcapi3</em> version 3.5 <a href="00Index.html">Index</a>]</div>
</body></html>
